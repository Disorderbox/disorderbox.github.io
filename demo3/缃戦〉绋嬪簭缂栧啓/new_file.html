<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>中文文本处理</title>

	<head>
		<style>
			/* CSS 样式 */
			body,
			html {
				margin: 0;
				padding: 0;
				overflow: hidden;
				/* 禁止页面滚动 */
				height: 100vh;
				/* 让页面占满整个视口 */
			}

			.box {
				display: flex;
				flex-direction: column;
			}

			.input-container {
				position: fixed;
				bottom: 0;
				width: 100%;
				display: flex;
				justify-content: center;
				align-items: center;
				background-color: #fff;
				padding: 10px;
				box-sizing: border-box;
				border-top: 3px solid #33F2F5;
			}

			#textInput {
				border: none;
				padding: 10px;
				font-size: 16px;
				resize: none;
				outline: none;
				width: calc(100% - 80px);
			}

			#submitButton {
				background-color: #33F2F5;
				color: #FFF;
				border: none;
				padding: 10px 20px;
				cursor: pointer;
				outline: none;
				border-radius: 5px;
				margin-left: 10px;
				/* 添加一些左侧间距 */
			}

			#resultContainer {
				background-color: #F5F5F5;
				padding: 20px;
				overflow: auto;
				/* 允许滚动 */
				text-align: center;
				position: absolute;
				box-sizing: border-box;
				top: 0;
				left: 0;
				width: 100%;
				bottom: 50px;
				flex: 1;
			}

			.randomStyle {
				transition: all 0.5s ease;
				position: absolute;
			}
		</style>
	</head>

<body>
	<div class="box">
		<div id="resultContainer"></div>

		<div class="input-container">
			<input type="text" id="textInput" placeholder="在这里输入中文文本">
			<button id="submitButton" onclick="processText()">处理文本</button>
		</div>
	</div>

	<script src="./js/mock.js"></script>



	<script>

		function getRandomNumber(min, max) {
			return Math.floor(Math.random() * (max - min + 1)) + min;
		}



		function shuffleArray(array) {
			// Fisher-Yates shuffle algorithm
			for (let i = array.length - 1; i > 0; i--) {
				const j = Math.floor(Math.random() * (i + 1));
				[array[i], array[j]] = [array[j], array[i]];
			}
			return array;
		}

		function insertRandomPunctuation(text) {
			// 在文本中随机插入 1 到 2 个标点符号
			const punctuations = ['。', '，', '！', '？', '；', '：'];
			const randomPunctuationCount = Math.floor(Math.random() * 2) + 1;
			let newText = text;
			for (let i = 0; i < randomPunctuationCount; i++) {
				const randomIndex = Math.floor(Math.random() * newText.length);
				const randomPunctuation = punctuations[Math.floor(Math.random() * punctuations.length)];
				newText = newText.slice(0, randomIndex) + randomPunctuation + newText.slice(randomIndex);
			}
			return newText;
		}

		function processText() {
			var inputText = document.getElementById("textInput").value.trim();
			var resultContainer = document.getElementById("resultContainer");

			// 清空之前的内容
			resultContainer.innerHTML = '';

			// 生成随机标点符号并插入文本
			var newText = insertRandomPunctuation(inputText);

			// 重新排序字符
			newText = shuffleArray(newText.split('')).join('');

			function generateRandomChinese(minLength, maxLength) {
				var result = '';
				var length = Math.floor(Math.random() * (maxLength - minLength + 1) + minLength);
				for (var i = 0; i < length; i++) {
					var randomUnicode = Math.floor(Math.random() * (40869 - 19968) + 19968);
					// 简体中文的Unicode范围为19968至40869
					result += String.fromCharCode(randomUnicode);
				}
				return result;
			}



			// 将随机生成的3到5位汉字
			// newText += generateRandomChinese(3, 5);
			var ctitle = Mock.Random.ctitle(3, 5)
			console.log(23232332, ctitle);
			newText += ctitle
			// 计算容器尺寸
			var containerWidth = resultContainer.clientWidth;
			var containerHeight = resultContainer.clientHeight;

			let frag = document.createDocumentFragment()

			var boxElement = document.createElement("p");
			boxElement.className = "randomStyle"; // 使用 className 替换 classList.add()


			console.log(12222, newText);
			for (let index = 0; index < newText.length; index++) {
				const elText = newText[index];
				// 创建文本元素
				var textElement = document.createElement("span");
				textElement.textContent = elText;

				// 随机样式...
				var randomFontSize = getRandomNumber(12, 250);
				console.log(11111, randomFontSize);
				textElement.style.fontSize = randomFontSize + 'px';

				var randomColor = '#' + Math.floor(Math.random() * 16777215).toString(16); // 随机颜色
				textElement.style.color = randomColor;

				var randomBackground = '#' + Math.floor(Math.random() * 16777215).toString(16); // 随机背景颜色
				textElement.style.backgroundColor = randomBackground;

				var fonts = ['Arial', "隶书", 'Times New Roman', "楷体", "微软雅黑", "宋体" ,"幼圆", "华文琥珀", "哥特式字体", "方正字迹-漫趣手写体简"];
				var randomFont = fonts[Math.floor(Math.random() * fonts.length)]; // 随机字体
				textElement.style.fontFamily = randomFont;
				frag.appendChild(textElement);
			}





			// 将文本添加到结果容器
			boxElement.appendChild(frag);
			resultContainer.appendChild(boxElement)

			function generateRandomNumber() {
				// 生成一个介于 0 到 1 之间的随机数
				var randomNumber = Math.random();

				// 根据随机数生成 0、1 或 2
				if (randomNumber < 1 / 3) {
					return 0;
				} else if (randomNumber < 2 / 3) {
					// return 1;
					return 0;
				} else {
					return 2;
				}
			}

			// 测试生成随机数的函数
			var randomNum = generateRandomNumber();

			var num = Math.floor(Math.random() * 180)

			const arr = [0, 180]

			boxElement.style.transform = `rotate(${arr[randomNum]}deg)`;

			console.log('textElement', containerHeight, boxElement.offsetWidth);
			// 随机位置...
			var randomLeft = Math.floor(Math.random() * (containerWidth - 20 - boxElement.offsetWidth)) + 'px';
			var randomTop = Math.floor(Math.random() * (containerHeight - 20 - boxElement.offsetHeight)) + 'px';

			// if (randomNum == 1) {
			// 	randomLeft = Math.floor(Math.random() * (containerWidth - 20 - boxElement.offsetHeight)) + 'px';
			// 	randomTop = Math.floor(Math.random() * (containerHeight - 20 - boxElement.offsetWidth)) + 'px';
			// }

			// 设置位置
			boxElement.style.left = randomLeft;
			boxElement.style.top = randomTop;


		}
	</script>
</body>

</html>